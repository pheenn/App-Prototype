<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Property Filters - SafeStay</title>
    <link href="assets/css/plus-jakarta-sans.css" rel="stylesheet" />
    <link href="assets/css/material-symbols.css" rel="stylesheet" />
    <script src="assets/js/tailwindcdn.js"></script>
    <script id="tailwind-config">
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              primary: "#13a4ec",
              "background-light": "#f6f7f8",
              "background-dark": "#101c22",
            },
            fontFamily: {
              display: ["Plus Jakarta Sans", "Noto Sans", "sans-serif"],
            },
            borderRadius: {
              DEFAULT: "0.5rem",
              lg: "1rem",
              xl: "1.5rem",
              full: "9999px",
            },
            boxShadow: {
              "primary-glow": "0 4px 20px -5px rgba(19, 164, 236, 0.6)",
            },
          },
        },
      };
    </script>
    <style>
      body {
        min-height: max(884px, 100dvh);
      }
      .range-slider {
        appearance: none;
        -webkit-appearance: none;
        width: 100%;
        height: 6px;
        background: transparent;
        outline: none;
        pointer-events: none;
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
      }
      .range-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 22px;
        height: 22px;
        background-color: #ffffff;
        border: 3px solid #13a4ec;
        border-radius: 50%;
        cursor: pointer;
        position: relative;
        z-index: 10;
        pointer-events: all;
        box-shadow: 0 8px 18px -8px rgba(19, 164, 236, 0.6);
      }
      .range-slider::-moz-range-thumb {
        width: 22px;
        height: 22px;
        background: #ffffff;
        border: 3px solid #13a4ec;
        border-radius: 50%;
        cursor: pointer;
      }
      .custom-checkbox {
        appearance: none;
        -webkit-appearance: none;
        height: 22px;
        width: 22px;
        border-radius: 8px;
        border: 1.5px solid #cbd5e1;
        transition: all 0.2s ease-in-out;
        cursor: pointer;
        position: relative;
        background: rgba(255, 255, 255, 0.8);
      }
      .custom-checkbox:checked {
        background-color: #13a4ec;
        border-color: #13a4ec;
        background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e");
        background-size: 100% 100%;
        background-position: center;
        background-repeat: no-repeat;
        box-shadow: 0 10px 22px -12px rgba(19, 164, 236, 0.6);
      }
      .dark .custom-checkbox {
        border-color: #475569;
        background: rgba(15, 23, 42, 0.7);
      }
      .dark .custom-checkbox:checked {
        background-color: #13a4ec;
        border-color: #13a4ec;
      }
      .sort-btn.active {
        background-color: #13a4ec;
        color: #ffffff;
        border-color: transparent;
        box-shadow: 0 18px 36px -20px rgba(19, 164, 236, 0.85);
      }
      .dark .sort-btn.active {
        background-color: rgba(19, 164, 236, 0.95);
      }
      .room-type-btn.selected {
        background-color: rgba(19, 164, 236, 0.1);
        border-color: transparent;
        color: #0b5fa8;
        box-shadow: inset 0 0 0 1px rgba(19, 164, 236, 0.3);
      }
      .dark .room-type-btn.selected {
        color: #bee3f8;
        background-color: rgba(19, 164, 236, 0.2);
      }
    </style>
  </head>
  <body class="font-display bg-background-light dark:bg-background-dark text-slate-900 dark:text-slate-100">
    <div class="relative flex min-h-screen flex-col bg-gradient-to-b from-background-light via-background-light/70 to-background-light dark:from-background-dark dark:via-background-dark/70 dark:to-background-dark">
      <header class="sticky top-0 z-20 border-b border-slate-200/70 bg-background-light/80 backdrop-blur-lg dark:border-slate-800/60 dark:bg-background-dark/80">
        <div class="mx-auto flex h-14 w-full max-w-3xl items-center gap-3 px-4">
          <a
            aria-label="Back"
            class="inline-flex size-10 items-center justify-center rounded-full text-slate-600 transition-colors hover:bg-slate-100 dark:text-slate-200 dark:hover:bg-slate-800"
            href="javascript:history.back()"
          >
            <span aria-hidden="true" class="material-symbols-outlined text-[24px]">arrow_back</span>
          </a>
          <div class="flex flex-1 items-center justify-between">
            <div>
              <h1 class="text-base font-bold leading-tight tracking-wide">Refine Your Stay</h1>
              <p class="text-xs text-slate-500 dark:text-slate-400">Tune your filters to find the safest fit.</p>
            </div>
            <button
              class="text-sm font-semibold uppercase tracking-wide text-primary transition-colors hover:text-primary/80"
              onclick="resetFilters()"
              type="button"
            >
              Reset
            </button>
          </div>
        </div>
      </header>
      <main class="flex-1 pb-28">
        <div class="mx-auto w-full max-w-3xl space-y-6 px-4 pt-6">
          <section class="rounded-2xl border border-slate-200 bg-white/90 p-4 shadow-xl shadow-slate-200/40 backdrop-blur-sm dark:border-slate-800 dark:bg-slate-900/70 dark:shadow-black/10">
            <div class="flex items-start justify-between gap-4">
              <div>
                <p class="text-sm font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-400">Active Filters</p>
                <h2 class="mt-1 text-lg font-bold">Your current preferences</h2>
              </div>
              <button
                class="inline-flex items-center gap-2 rounded-full border border-slate-200 px-3 py-1.5 text-xs font-semibold uppercase tracking-wide text-slate-500 transition-colors hover:border-primary hover:text-primary dark:border-slate-700 dark:text-slate-300"
                onclick="clearAllFilters(event)"
                type="button"
              >
                <span class="material-symbols-outlined text-sm">close</span>
                Clear All
              </button>
            </div>
            <div class="mt-4 flex flex-wrap gap-2" id="filter-summary">
              <span class="text-sm text-slate-500 dark:text-slate-400">No filters applied yet.</span>
            </div>
          </section>

          <section class="rounded-2xl border border-slate-200 bg-white/95 p-5 shadow-lg shadow-slate-200/50 backdrop-blur-sm dark:border-slate-800 dark:bg-slate-900/80 dark:shadow-black/20">
            <div class="flex items-center justify-between">
              <h3 class="text-lg font-bold">Budget Range</h3>
              <p class="text-sm font-semibold text-primary" id="price-display">₱500 - ₱12,000</p>
            </div>
            <p class="mt-2 text-xs text-slate-500 dark:text-slate-400">Set a comfortable monthly rate to narrow the options.</p>
            <div class="relative mt-6 h-12">
              <div class="absolute inset-x-0 top-1/2 -translate-y-1/2">
                <div class="h-1.5 w-full rounded-full bg-slate-200 dark:bg-slate-700/60">
                  <div id="price-range-fill" class="h-1.5 rounded-full bg-primary transition-all" style="margin-left: 15%; width: 70%"></div>
                </div>
                <div class="pointer-events-none absolute inset-x-0 -top-6 flex justify-between text-xs font-medium text-slate-500 dark:text-slate-400">
                  <span>₱500</span>
                  <span>₱12,000</span>
                </div>
                <input aria-label="Minimum price" class="range-slider" id="min-price" max="100" min="0" oninput="updatePriceRange()" type="range" value="0" />
                <input aria-label="Maximum price" class="range-slider" id="max-price" max="100" min="0" oninput="updatePriceRange()" type="range" value="100" />
              </div>
            </div>
          </section>

          <section class="rounded-2xl border border-slate-200 bg-white/95 p-5 shadow-lg shadow-slate-200/50 backdrop-blur-sm dark:border-slate-800 dark:bg-slate-900/80 dark:shadow-black/20">
            <h3 class="text-lg font-bold">Sort Options</h3>
            <p class="mt-1 text-xs text-slate-500 dark:text-slate-400">Pick how listings show up first.</p>
            <div class="mt-4 grid gap-3">
              <button class="sort-btn active flex items-center justify-between rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-semibold text-slate-600 transition-all hover:border-primary dark:border-slate-700 dark:bg-slate-900/70 dark:text-slate-200" data-sort="distance" onclick="selectSort(this, 'distance')" type="button">
                <span>Distance: Nearest First</span>
                <span class="material-symbols-outlined text-lg">near_me</span>
              </button>
              <button class="sort-btn flex items-center justify-between rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-semibold text-slate-600 transition-all hover:border-primary dark:border-slate-700 dark:bg-slate-900/70 dark:text-slate-200" data-sort="rating" onclick="selectSort(this, 'rating')" type="button">
                <span>Rating: Highest First</span>
                <span class="material-symbols-outlined text-lg">stars</span>
              </button>
              <button class="sort-btn flex items-center justify-between rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-semibold text-slate-600 transition-all hover:border-primary dark:border-slate-700 dark:bg-slate-900/70 dark:text-slate-200" data-sort="price-low" onclick="selectSort(this, 'price-low')" type="button">
                <span>Price: Low to High</span>
                <span class="material-symbols-outlined text-lg">trending_up</span>
              </button>
              <button class="sort-btn flex items-center justify-between rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-semibold text-slate-600 transition-all hover:border-primary dark:border-slate-700 dark:bg-slate-900/70 dark:text-slate-200" data-sort="price-high" onclick="selectSort(this, 'price-high')" type="button">
                <span>Price: High to Low</span>
                <span class="material-symbols-outlined text-lg">trending_down</span>
              </button>
            </div>
          </section>

          <section class="rounded-2xl border border-slate-200 bg-white/95 p-5 shadow-lg shadow-slate-200/50 backdrop-blur-sm dark:border-slate-800 dark:bg-slate-900/80 dark:shadow-black/20">
            <h3 class="text-lg font-bold">Essential Amenities</h3>
            <p class="mt-1 text-xs text-slate-500 dark:text-slate-400">Select the comforts you can’t live without.</p>
            <div class="mt-4 grid gap-3 sm:grid-cols-2">
              <label class="flex items-center justify-between rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-medium text-slate-600 transition-colors hover:border-primary hover:shadow-md dark:border-slate-700 dark:bg-slate-900/70 dark:text-slate-200">
                <span>Wi-Fi Included</span>
                <input class="custom-checkbox amenity-checkbox" name="amenities" type="checkbox" value="wifi" />
              </label>
              <label class="flex items-center justify-between rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-medium text-slate-600 transition-colors hover:border-primary hover:shadow-md dark:border-slate-700 dark:bg-slate-900/70 dark:text-slate-200">
                <span>Private Bathroom</span>
                <input class="custom-checkbox amenity-checkbox" name="amenities" type="checkbox" value="private-bathroom" />
              </label>
              <label class="flex items-center justify-between rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-medium text-slate-600 transition-colors hover:border-primary hover:shadow-md dark:border-slate-700 dark:bg-slate-900/70 dark:text-slate-200">
                <span>Air Conditioning</span>
                <input class="custom-checkbox amenity-checkbox" name="amenities" type="checkbox" value="ac" />
              </label>
              <label class="flex items-center justify-between rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-medium text-slate-600 transition-colors hover:border-primary hover:shadow-md dark:border-slate-700 dark:bg-slate-900/70 dark:text-slate-200">
                <span>24/7 Security</span>
                <input class="custom-checkbox amenity-checkbox" name="amenities" type="checkbox" value="security" />
              </label>
              <label class="flex items-center justify-between rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-medium text-slate-600 transition-colors hover:border-primary hover:shadow-md dark:border-slate-700 dark:bg-slate-900/70 dark:text-slate-200">
                <span>Kitchen Access</span>
                <input class="custom-checkbox amenity-checkbox" name="amenities" type="checkbox" value="kitchen" />
              </label>
              <label class="flex items-center justify-between rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-medium text-slate-600 transition-colors hover:border-primary hover:shadow-md dark:border-slate-700 dark:bg-slate-900/70 dark:text-slate-200">
                <span>Laundry Service</span>
                <input class="custom-checkbox amenity-checkbox" name="amenities" type="checkbox" value="laundry" />
              </label>
              <label class="flex items-center justify-between rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-medium text-slate-600 transition-colors hover:border-primary hover:shadow-md dark:border-slate-700 dark:bg-slate-900/70 dark:text-slate-200 sm:col-span-2">
                <span>Parking Space</span>
                <input class="custom-checkbox amenity-checkbox" name="amenities" type="checkbox" value="parking" />
              </label>
            </div>
          </section>

          <section class="rounded-2xl border border-slate-200 bg-white/95 p-5 shadow-lg shadow-slate-200/50 backdrop-blur-sm dark:border-slate-800 dark:bg-slate-900/80 dark:shadow-black/20">
            <h3 class="text-lg font-bold">Room Configuration</h3>
            <p class="mt-1 text-xs text-slate-500 dark:text-slate-400">Choose layouts that fit your routine.</p>
            <div class="mt-4 grid gap-3 sm:grid-cols-2">
              <button class="room-type-btn rounded-xl border border-slate-200 bg-white px-4 py-3 text-left text-sm font-medium text-slate-600 transition-all hover:border-primary hover:shadow-md dark:border-slate-700 dark:bg-slate-900/70 dark:text-slate-200" data-type="single" onclick="selectRoomType(this, 'single')" type="button">
                <div class="flex items-center gap-3">
                  <span class="material-symbols-outlined text-2xl text-primary/70">bed</span>
                  <div>
                    <p class="font-semibold">Single Room</p>
                    <p class="text-xs text-slate-500 dark:text-slate-400">Personal space with essentials.</p>
                  </div>
                </div>
              </button>
              <button class="room-type-btn rounded-xl border border-slate-200 bg-white px-4 py-3 text-left text-sm font-medium text-slate-600 transition-all hover:border-primary hover:shadow-md dark:border-slate-700 dark:bg-slate-900/70 dark:text-slate-200" data-type="shared" onclick="selectRoomType(this, 'shared')" type="button">
                <div class="flex items-center gap-3">
                  <span class="material-symbols-outlined text-2xl text-primary/70">group</span>
                  <div>
                    <p class="font-semibold">Shared Room</p>
                    <p class="text-xs text-slate-500 dark:text-slate-400">Budget friendly with roommates.</p>
                  </div>
                </div>
              </button>
              <button class="room-type-btn rounded-xl border border-slate-200 bg-white px-4 py-3 text-left text-sm font-medium text-slate-600 transition-all hover:border-primary hover:shadow-md dark:border-slate-700 dark:bg-slate-900/70 dark:text-slate-200" data-type="studio" onclick="selectRoomType(this, 'studio')" type="button">
                <div class="flex items-center gap-3">
                  <span class="material-symbols-outlined text-2xl text-primary/70">night_shelter</span>
                  <div>
                    <p class="font-semibold">Studio Type</p>
                    <p class="text-xs text-slate-500 dark:text-slate-400">All-in-one compact living.</p>
                  </div>
                </div>
              </button>
              <button class="room-type-btn rounded-xl border border-slate-200 bg-white px-4 py-3 text-left text-sm font-medium text-slate-600 transition-all hover:border-primary hover:shadow-md dark:border-slate-700 dark:bg-slate-900/70 dark:text-slate-200" data-type="apartment" onclick="selectRoomType(this, 'apartment')" type="button">
                <div class="flex items-center gap-3">
                  <span class="material-symbols-outlined text-2xl text-primary/70">apartment</span>
                  <div>
                    <p class="font-semibold">Apartment</p>
                    <p class="text-xs text-slate-500 dark:text-slate-400">Flexible layout for groups.</p>
                  </div>
                </div>
              </button>
            </div>
          </section>

          <section class="rounded-2xl border border-slate-200 bg-white/95 p-5 shadow-lg shadow-slate-200/50 backdrop-blur-sm dark:border-slate-800 dark:bg-slate-900/80 dark:shadow-black/20">
            <h3 class="text-lg font-bold">Distance from University</h3>
            <p class="mt-1 text-xs text-slate-500 dark:text-slate-400">Stay close enough for your lifestyle.</p>
            <div class="mt-4 space-y-3">
              <label class="flex items-center gap-3 rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-medium text-slate-600 transition-colors hover:border-primary hover:shadow-md dark:border-slate-700 dark:bg-slate-900/70 dark:text-slate-200">
                <input class="h-5 w-5 accent-primary" name="distance" type="radio" value="walking" />
                <span>Walking distance (0-1 km)</span>
              </label>
              <label class="flex items-center gap-3 rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-medium text-slate-600 transition-colors hover:border-primary hover:shadow-md dark:border-slate-700 dark:bg-slate-900/70 dark:text-slate-200">
                <input checked class="h-5 w-5 accent-primary" name="distance" type="radio" value="bike" />
                <span>Biking distance (1-3 km)</span>
              </label>
              <label class="flex items-center gap-3 rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-medium text-slate-600 transition-colors hover:border-primary hover:shadow-md dark:border-slate-700 dark:bg-slate-900/70 dark:text-slate-200">
                <input class="h-5 w-5 accent-primary" name="distance" type="radio" value="transport" />
                <span>Transport needed (3 km+)</span>
              </label>
            </div>
          </section>
        </div>
      </main>
      <footer class="sticky bottom-0 z-20 border-t border-slate-200/70 bg-background-light/90 px-4 py-4 backdrop-blur-lg dark:border-slate-800/70 dark:bg-background-dark/90">
        <div class="mx-auto flex w-full max-w-3xl flex-col gap-3 sm:flex-row">
          <button class="flex-1 rounded-xl border border-slate-300 bg-white/90 py-3 text-base font-semibold text-slate-600 transition-colors hover:border-primary hover:text-primary hover:shadow-md dark:border-slate-700 dark:bg-slate-900/80 dark:text-slate-300" onclick="clearAllFilters(event)" type="button">
            Clear Selection
          </button>
          <button class="flex-[1.6] rounded-xl bg-primary py-3 text-base font-bold uppercase tracking-wide text-white shadow-lg shadow-sky-500/30 transition-transform hover:-translate-y-0.5 hover:bg-primary/90" id="apply-btn" onclick="applyFilters()" type="button">
            Apply Filters
          </button>
        </div>
      </footer>
    </div>

    <script>
      const DEFAULT_PRICE_MIN = 500;
      const DEFAULT_PRICE_MAX = 12000;
      const PRICE_STEP = 50;

      const amenityLabels = {
        wifi: 'Wi-Fi',
        'private-bathroom': 'Private Bathroom',
        ac: 'Air Conditioning',
        security: '24/7 Security',
        kitchen: 'Kitchen Access',
        laundry: 'Laundry Service',
        parking: 'Parking'
      };

      const roomTypeLabels = {
        single: 'Single Room',
        shared: 'Shared Room',
        studio: 'Studio Type',
        apartment: 'Apartment'
      };

      const distanceLabels = {
        walking: '0-1 km (Walkable)',
        bike: '1-3 km (Bike Friendly)',
        transport: '3 km+ (Ride Recommended)'
      };

      const sortLabels = {
        distance: 'Nearest First',
        rating: 'Highest Rating',
        'price-low': 'Price: Low to High',
        'price-high': 'Price: High to Low'
      };

      let filterState = {
        minPrice: DEFAULT_PRICE_MIN,
        maxPrice: DEFAULT_PRICE_MAX,
        sortBy: 'distance',
        amenities: [],
        roomTypes: [],
        distance: 'bike'
      };

      document.addEventListener('DOMContentLoaded', () => {
        updatePriceRange();
      });

      function roundToStep(value, step = PRICE_STEP) {
        return Math.round(value / step) * step;
      }

      function updatePriceRange() {
        const minSlider = document.getElementById('min-price');
        const maxSlider = document.getElementById('max-price');
        const priceDisplay = document.getElementById('price-display');
        const rangeFill = document.getElementById('price-range-fill');

        if (!minSlider || !maxSlider || !priceDisplay || !rangeFill) {
          return;
        }

        let minVal = Number(minSlider.value);
        let maxVal = Number(maxSlider.value);

        if (minVal >= maxVal) {
          if (minSlider === document.activeElement) {
            maxVal = Math.min(minVal + 1, 100);
            maxSlider.value = maxVal;
          } else {
            minVal = Math.max(maxVal - 1, 0);
            minSlider.value = minVal;
          }
        }

        const priceRange = DEFAULT_PRICE_MAX - DEFAULT_PRICE_MIN;
        const minPrice = DEFAULT_PRICE_MIN + (minVal / 100) * priceRange;
        const maxPrice = DEFAULT_PRICE_MIN + (maxVal / 100) * priceRange;

        filterState.minPrice = roundToStep(minPrice);
        filterState.maxPrice = roundToStep(maxPrice);

        priceDisplay.textContent = `₱${filterState.minPrice.toLocaleString()} - ₱${filterState.maxPrice.toLocaleString()}`;

        rangeFill.style.marginLeft = `${minVal}%`;
        rangeFill.style.width = `${Math.max(maxVal - minVal, 1)}%`;

        updateApplyButton();
      }

      function selectSort(button, sortType) {
        document.querySelectorAll('.sort-btn').forEach(btn => btn.classList.remove('active'));
        button.classList.add('active');
        filterState.sortBy = sortType;
        updateApplyButton();
      }

      function selectRoomType(button, roomType) {
        const isSelected = button.classList.contains('selected');

        if (isSelected) {
          button.classList.remove('selected', 'text-primary', 'dark:text-slate-100');
          if (!button.classList.contains('text-slate-600')) {
            button.classList.add('text-slate-600');
          }
          if (!button.classList.contains('dark:text-slate-200')) {
            button.classList.add('dark:text-slate-200');
          }
          filterState.roomTypes = filterState.roomTypes.filter(type => type !== roomType);
        } else {
          button.classList.add('selected', 'text-primary', 'dark:text-slate-100');
          button.classList.remove('text-slate-600', 'dark:text-slate-200');
          if (!filterState.roomTypes.includes(roomType)) {
            filterState.roomTypes.push(roomType);
          }
        }

        updateApplyButton();
      }

      document.addEventListener('change', event => {
        const target = event.target;

        if (target.classList && target.classList.contains('amenity-checkbox')) {
          const amenity = target.value;
          if (target.checked) {
            if (!filterState.amenities.includes(amenity)) {
              filterState.amenities.push(amenity);
            }
          } else {
            filterState.amenities = filterState.amenities.filter(item => item !== amenity);
          }
          updateApplyButton();
        }

        if (target.name === 'distance') {
          filterState.distance = target.value;
          updateApplyButton();
        }
      });

      function updateApplyButton() {
        const applyBtn = document.getElementById('apply-btn');
        if (!applyBtn) return;

        let filterCount = 0;
        if (filterState.minPrice > DEFAULT_PRICE_MIN || filterState.maxPrice < DEFAULT_PRICE_MAX) filterCount++;
        if (filterState.amenities.length) filterCount++;
        if (filterState.roomTypes.length) filterCount++;
        if (filterState.sortBy !== 'distance') filterCount++;
        if (filterState.distance !== 'bike') filterCount++;

        applyBtn.disabled = false;
        applyBtn.classList.remove('opacity-70', 'cursor-not-allowed', 'bg-green-500');
        applyBtn.textContent = filterCount ? `Apply Filters (${filterCount})` : 'Apply Filters';

        renderSummaryChips();
      }

      function renderSummaryChips() {
        const summary = document.getElementById('filter-summary');
        if (!summary) return;

        const chips = [];

        if (filterState.minPrice > DEFAULT_PRICE_MIN || filterState.maxPrice < DEFAULT_PRICE_MAX) {
          chips.push(`Budget: ₱${filterState.minPrice.toLocaleString()} - ₱${filterState.maxPrice.toLocaleString()}`);
        }

        if (filterState.amenities.length) {
          const formatted = filterState.amenities
            .map(key => amenityLabels[key] || key)
            .sort();
          const display = formatted.slice(0, 3).join(', ');
          const remainder = formatted.length - 3;
          chips.push(`Amenities: ${display}${remainder > 0 ? ` +${remainder} more` : ''}`);
        }

        if (filterState.roomTypes.length) {
          const formatted = filterState.roomTypes
            .map(key => roomTypeLabels[key] || key)
            .join(', ');
          chips.push(`Room: ${formatted}`);
        }

        if (filterState.distance !== 'bike') {
          chips.push(`Distance: ${distanceLabels[filterState.distance] || filterState.distance}`);
        }

        if (filterState.sortBy !== 'distance') {
          chips.push(`Sort: ${sortLabels[filterState.sortBy] || filterState.sortBy}`);
        }

        summary.innerHTML = chips.length
          ? chips
              .map(chip => `<span class="inline-flex items-center gap-1 rounded-full bg-primary/10 px-3 py-1 text-xs font-semibold text-primary dark:bg-primary/20">${chip}</span>`)
              .join('')
          : '<span class="text-sm text-slate-500 dark:text-slate-400">No filters applied yet.</span>';
      }

      function resetFilters() {
        const minSlider = document.getElementById('min-price');
        const maxSlider = document.getElementById('max-price');

        if (minSlider) minSlider.value = 0;
        if (maxSlider) maxSlider.value = 100;

        document.querySelectorAll('.amenity-checkbox').forEach(cb => {
          cb.checked = false;
        });

        document.querySelectorAll('.sort-btn').forEach(btn => btn.classList.remove('active'));
        const defaultSort = document.querySelector('.sort-btn[data-sort="distance"]');
        if (defaultSort) defaultSort.classList.add('active');

        document.querySelectorAll('.room-type-btn').forEach(btn => {
          btn.classList.remove('selected', 'text-primary', 'dark:text-slate-100');
          if (!btn.classList.contains('text-slate-600')) {
            btn.classList.add('text-slate-600');
          }
          if (!btn.classList.contains('dark:text-slate-200')) {
            btn.classList.add('dark:text-slate-200');
          }
        });

        const distanceDefault = document.querySelector('input[name="distance"][value="bike"]');
        if (distanceDefault) distanceDefault.checked = true;

        filterState = {
          minPrice: DEFAULT_PRICE_MIN,
          maxPrice: DEFAULT_PRICE_MAX,
          sortBy: 'distance',
          amenities: [],
          roomTypes: [],
          distance: 'bike'
        };

        updatePriceRange();
      }

      function clearAllFilters(event) {
        if (event) {
          event.preventDefault();
        }

        resetFilters();

        const clearBtn = event && event.currentTarget ? event.currentTarget : null;
        if (clearBtn) {
          const originalText = clearBtn.textContent.trim();
          clearBtn.textContent = 'Cleared!';
          clearBtn.classList.add('bg-green-500', 'text-white');

          setTimeout(() => {
            clearBtn.textContent = originalText;
            clearBtn.classList.remove('bg-green-500', 'text-white');
          }, 900);
        }
      }

      function applyFilters() {
        const applyBtn = document.getElementById('apply-btn');
        if (!applyBtn) return;

        const originalText = applyBtn.textContent;

        applyBtn.textContent = 'Applying...';
        applyBtn.disabled = true;
        applyBtn.classList.add('opacity-70', 'cursor-not-allowed');

        console.log('Applied filters:', filterState);

        setTimeout(() => {
          applyBtn.textContent = 'Applied!';
          applyBtn.classList.remove('opacity-70', 'cursor-not-allowed');
          applyBtn.classList.add('bg-green-500');

          setTimeout(() => {
            applyBtn.classList.remove('bg-green-500');
            applyBtn.disabled = false;
            applyBtn.textContent = originalText;
            updateApplyButton();
            window.location.href = 'search_results.html';
          }, 600);
        }, 900);
      }
    </script>
  </body>
</html>
