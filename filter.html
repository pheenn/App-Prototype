<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Property Filters - SafeStay</title>
  <link href="assets/css/plus-jakarta-sans.css" rel="stylesheet" />
  <link href="assets/css/material-symbols.css" rel="stylesheet" />
  <script src="assets/js/tailwindcdn.js"></script>
    <script id="tailwind-config">
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              primary: "#13a4ec",
              "background-light": "#f6f7f8",
              "background-dark": "#101c22",
            },
            fontFamily: {
              display: ["Plus Jakarta Sans", "Noto Sans", "sans-serif"],
            },
            borderRadius: {
              DEFAULT: "0.5rem",
              lg: "1rem",
              xl: "1.5rem",
              full: "9999px",
            },
            boxShadow: {
              "primary-glow": "0 4px 20px -5px rgba(19, 164, 236, 0.6)",
            },
          },
        },
      };
    </script>
    <style>
      .range-slider {
        appearance: none;
        -webkit-appearance: none;
        width: 100%;
        height: 6px;
        background: transparent;
        outline: none;
        opacity: 1;
        transition: opacity 0.2s;
        border-radius: 9999px;
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        pointer-events: none;
      }
      .range-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 24px;
        height: 24px;
        background-color: white;
        border: 3px solid #13a4ec;
        cursor: pointer;
        border-radius: 50%;
        position: relative;
        z-index: 10;
        pointer-events: all;
        box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.2);
      }
      .range-slider::-moz-range-thumb {
        width: 24px;
        height: 24px;
        background: white;
        border: 3px solid #13a4ec;
        cursor: pointer;
        border-radius: 50%;
      }
      .glassmorphism {
        background: rgba(255, 255, 255, 0.6);
        backdrop-filter: blur(15px);
        -webkit-backdrop-filter: blur(15px);
      }
      .dark .glassmorphism {
        background: rgba(16, 28, 34, 0.7);
      }
      .custom-checkbox {
        appearance: none;
        -webkit-appearance: none;
        height: 24px;
        width: 24px;
        border-radius: 8px;
        border: 1.5px solid #cbd5e1;
        transition: all 0.2s ease-in-out;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        cursor: pointer;
        position: relative;
      }
      .custom-checkbox:checked {
        background-color: #13a4ec;
        border-color: #13a4ec;
        background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e");
        background-size: 100% 100%;
        background-position: center;
        background-repeat: no-repeat;
      }
      .dark .custom-checkbox {
        border-color: #4a5568;
      }
      .dark .custom-checkbox:checked {
        background-color: #13a4ec;
        border-color: #13a4ec;
      }
    </style>
    <style>
      body {
        min-height: max(884px, 100dvh);
      }
    </style>
  </head>
  <body class="font-display bg-background-light dark:bg-background-dark">
    <div
      class="relative flex min-h-screen w-full flex-col bg-cover bg-center bg-no-repeat group/design-root"
      style="
        background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuAS2kyhAq43aIU9NMGkFAGEx-OmDgmHaOxIBOfQOBZRwOkt7PzSgh1byu7_46Lda4vjCLIC2bMGgvu7b-N9BeAQuD-g2qzaX1oW7ummGHhz2ZnVqq0XPTOlGQ7F-W5tQQ17G51WVz9eBykwTaj6HXwjTOo_QCXCr_OaUWswS1JlNoxejyJqLW-BvVPAYxOFtqJ3o9oTLLsR8egXJbDJWFX5xRTJ89KZo99fwD6GP6eHnU7WXshcdO8u_V7CzxMQ9ePK4Ui98GA3Dg');
      "
    >
      <div class="absolute inset-0 bg-black/20 dark:bg-black/40"></div>
      <div
        class="absolute bottom-0 left-0 right-0 mt-auto flex h-full max-h-[95vh] flex-col"
      >
        <div class="flex-grow"></div>
        <div class="glassmorphism rounded-t-xl shadow-2xl">
          <div class="flex flex-col items-center p-3">
            <div
              class="h-1.5 w-10 rounded-full bg-gray-300 dark:bg-gray-600"
            ></div>
          </div>
          <div
            class="flex items-center border-b border-gray-200/50 dark:border-gray-700/50 px-5 pb-4 pt-2"
          >
            <button 
              onclick="closeFilters()"
              class="text-gray-700 dark:text-gray-200 hover:text-gray-900 dark:hover:text-white transition-colors"
              aria-label="Close filters"
            >
              <span class="material-symbols-outlined text-3xl">close</span>
            </button>
            <h2
              class="flex-1 text-center text-xl font-bold text-gray-900 dark:text-white"
            >
              Filters
            </h2>
            <button 
              onclick="resetFilters()"
              class="w-16 text-base font-semibold text-primary hover:text-primary/80 transition-colors"
            >
              Reset
            </button>
          </div>
          <div class="flex-1 overflow-y-auto px-5 pb-4 pt-6">
            <div class="space-y-8">
              <div>
                <div class="flex items-baseline justify-between mb-4">
                  <h3 class="text-lg font-bold text-gray-900 dark:text-white">
                    Price Range
                  </h3>
                  <p class="text-base font-semibold text-primary" id="price-display">
                    ₱1,500 - ₱8,500
                  </p>
                </div>
                <div class="relative h-12">
                  <div class="absolute top-1/2 left-0 w-full -translate-y-1/2">
                    <div
                      class="h-1.5 w-full rounded-full bg-gray-300 dark:bg-gray-700/50"
                    >
                      <div
                        id="price-range-fill"
                        class="h-1.5 rounded-full bg-primary"
                        style="margin-left: 15%; width: 70%"
                      ></div>
                    </div>
                    <div
                      class="absolute inset-x-0 top-1/2 -translate-y-1/2 flex justify-between"
                    >
                      <span
                        class="text-xs font-medium text-gray-500 dark:text-gray-400"
                        >₱500</span
                      >
                      <span
                        class="text-xs font-medium text-gray-500 dark:text-gray-400"
                        >₱12,000</span
                      >
                    </div>
                    <input
                      id="min-price"
                      class="range-slider"
                      max="100"
                      min="0"
                      type="range"
                      value="15"
                      oninput="updatePriceRange()"
                      aria-label="Minimum price"
                    />
                    <input
                      id="max-price"
                      class="range-slider"
                      max="100"
                      min="0"
                      type="range"
                      value="85"
                      oninput="updatePriceRange()"
                      aria-label="Maximum price"
                    />
                  </div>
                </div>
              </div>
              <div class="space-y-4">
                <h3 class="text-lg font-bold text-gray-900 dark:text-white">
                  Sort By
                </h3>
                <div class="grid grid-cols-1 gap-3">
                  <button
                    onclick="selectSort(this, 'distance')"
                    class="sort-btn active rounded-full px-4 py-2.5 text-sm font-medium transition-colors duration-300 bg-primary text-white shadow-sm"
                    data-sort="distance"
                  >
                    Distance: Nearest First
                  </button>
                  <button
                    onclick="selectSort(this, 'rating')"
                    class="sort-btn rounded-full px-4 py-2.5 text-sm font-medium transition-colors duration-300 bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600"
                    data-sort="rating"
                  >
                    Rating: Highest First
                  </button>
                  <button
                    onclick="selectSort(this, 'price-low')"
                    class="sort-btn rounded-full px-4 py-2.5 text-sm font-medium transition-colors duration-300 bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600"
                    data-sort="price-low"
                  >
                    Price: Low to High
                  </button>
                  <button
                    onclick="selectSort(this, 'price-high')"
                    class="sort-btn rounded-full px-4 py-2.5 text-sm font-medium transition-colors duration-300 bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600"
                    data-sort="price-high"
                  >
                    Price: High to Low
                  </button>
                </div>
              </div>
              <div class="space-y-4">
                <h3 class="text-lg font-bold text-gray-900 dark:text-white">
                  Amenities
                </h3>
                <div class="space-y-4 pt-2">
                  <label class="flex items-center justify-between cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50 p-2 rounded-lg transition-colors">
                    <span class="text-base text-gray-800 dark:text-gray-200"
                      >Wi-Fi Included</span
                    >
                    <input 
                      checked 
                      class="custom-checkbox amenity-checkbox" 
                      type="checkbox" 
                      value="wifi"
                      name="amenities"
                    />
                  </label>
                  <label class="flex items-center justify-between cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50 p-2 rounded-lg transition-colors">
                    <span class="text-base text-gray-800 dark:text-gray-200"
                      >Private Bathroom</span
                    >
                    <input 
                      class="custom-checkbox amenity-checkbox" 
                      type="checkbox" 
                      value="private-bathroom"
                      name="amenities"
                    />
                  </label>
                  <label class="flex items-center justify-between cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50 p-2 rounded-lg transition-colors">
                    <span class="text-base text-gray-800 dark:text-gray-200"
                      >Air Conditioning</span
                    >
                    <input 
                      class="custom-checkbox amenity-checkbox" 
                      type="checkbox" 
                      value="ac"
                      name="amenities"
                    />
                  </label>
                  <label class="flex items-center justify-between cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50 p-2 rounded-lg transition-colors">
                    <span class="text-base text-gray-800 dark:text-gray-200"
                      >24/7 Security</span
                    >
                    <input 
                      checked 
                      class="custom-checkbox amenity-checkbox" 
                      type="checkbox" 
                      value="security"
                      name="amenities"
                    />
                  </label>
                  <label class="flex items-center justify-between cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50 p-2 rounded-lg transition-colors">
                    <span class="text-base text-gray-800 dark:text-gray-200"
                      >Kitchen Access</span
                    >
                    <input 
                      class="custom-checkbox amenity-checkbox" 
                      type="checkbox" 
                      value="kitchen"
                      name="amenities"
                    />
                  </label>
                  <label class="flex items-center justify-between cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50 p-2 rounded-lg transition-colors">
                    <span class="text-base text-gray-800 dark:text-gray-200"
                      >Laundry Service</span
                    >
                    <input 
                      class="custom-checkbox amenity-checkbox" 
                      type="checkbox" 
                      value="laundry"
                      name="amenities"
                    />
                  </label>
                  <label class="flex items-center justify-between cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50 p-2 rounded-lg transition-colors">
                    <span class="text-base text-gray-800 dark:text-gray-200"
                      >Parking Space</span
                    >
                    <input 
                      class="custom-checkbox amenity-checkbox" 
                      type="checkbox" 
                      value="parking"
                      name="amenities"
                    />
                  </label>
                </div>
              </div>
              
              <!-- Room Configuration -->
              <div class="space-y-4">
                <h3 class="text-lg font-bold text-gray-900 dark:text-white">
                  Room Configuration
                </h3>
                <div class="grid grid-cols-2 gap-3">
                  <button
                    onclick="selectRoomType(this, 'single')"
                    class="room-type-btn rounded-lg border-2 border-gray-200 dark:border-gray-700 px-4 py-3 text-sm font-medium transition-all duration-200 hover:border-primary/50 focus:outline-none focus:ring-2 focus:ring-primary/20"
                    data-type="single"
                  >
                    Single Room
                  </button>
                  <button
                    onclick="selectRoomType(this, 'shared')"
                    class="room-type-btn rounded-lg border-2 border-gray-200 dark:border-gray-700 px-4 py-3 text-sm font-medium transition-all duration-200 hover:border-primary/50 focus:outline-none focus:ring-2 focus:ring-primary/20"
                    data-type="shared"
                  >
                    Shared Room
                  </button>
                  <button
                    onclick="selectRoomType(this, 'studio')"
                    class="room-type-btn rounded-lg border-2 border-gray-200 dark:border-gray-700 px-4 py-3 text-sm font-medium transition-all duration-200 hover:border-primary/50 focus:outline-none focus:ring-2 focus:ring-primary/20"
                    data-type="studio"
                  >
                    Studio Type
                  </button>
                  <button
                    onclick="selectRoomType(this, 'apartment')"
                    class="room-type-btn rounded-lg border-2 border-gray-200 dark:border-gray-700 px-4 py-3 text-sm font-medium transition-all duration-200 hover:border-primary/50 focus:outline-none focus:ring-2 focus:ring-primary/20"
                    data-type="apartment"
                  >
                    Apartment
                  </button>
                </div>
              </div>

              <!-- Distance from University -->
              <div class="space-y-4">
                <h3 class="text-lg font-bold text-gray-900 dark:text-white">
                  Distance from University
                </h3>
                <div class="space-y-3">
                  <label class="flex items-center cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50 p-2 rounded-lg transition-colors">
                    <input 
                      type="radio" 
                      name="distance" 
                      value="walking"
                      class="w-5 h-5 text-primary bg-gray-100 border-gray-300 focus:ring-primary dark:focus:ring-primary dark:ring-offset-gray-800 dark:bg-gray-700 dark:border-gray-600"
                    />
                    <span class="ml-3 text-sm text-gray-800 dark:text-gray-200">Walking distance (0-1km)</span>
                  </label>
                  <label class="flex items-center cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50 p-2 rounded-lg transition-colors">
                    <input 
                      type="radio" 
                      name="distance" 
                      value="bike"
                      checked
                      class="w-5 h-5 text-primary bg-gray-100 border-gray-300 focus:ring-primary dark:focus:ring-primary dark:ring-offset-gray-800 dark:bg-gray-700 dark:border-gray-600"
                    />
                    <span class="ml-3 text-sm text-gray-800 dark:text-gray-200">Biking distance (1-3km)</span>
                  </label>
                  <label class="flex items-center cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50 p-2 rounded-lg transition-colors">
                    <input 
                      type="radio" 
                      name="distance" 
                      value="transport"
                      class="w-5 h-5 text-primary bg-gray-100 border-gray-300 focus:ring-primary dark:focus:ring-primary dark:ring-offset-gray-800 dark:bg-gray-700 dark:border-gray-600"
                    />
                    <span class="ml-3 text-sm text-gray-800 dark:text-gray-200">Transport needed (3km+)</span>
                  </label>
                </div>
              </div>
            </div>
          </div>
          <div class="border-t border-gray-200/50 dark:border-gray-700/50 p-5">
            <div class="flex gap-3">
              <button
                onclick="clearAllFilters()"
                class="flex-1 rounded-xl border-2 border-gray-200 dark:border-gray-700 py-3 text-base font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors"
              >
                Clear All
              </button>
              <button
                onclick="applyFilters()"
                class="flex-[2] rounded-xl bg-primary py-3 text-base font-bold text-white shadow-primary-glow transition-transform duration-200 ease-in-out active:scale-95 hover:bg-primary/90"
                id="apply-btn"
              >
                Apply Filters
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Filter state management
      let filterState = {
        minPrice: 1500,
        maxPrice: 8500,
        sortBy: 'distance',
        amenities: ['wifi', 'security'],
        roomTypes: [],
        distance: 'bike'
      };

      // Initialize filters
      document.addEventListener('DOMContentLoaded', function() {
        updatePriceRange();
        updateApplyButton();
      });

      // Price range functionality
      function updatePriceRange() {
        const minSlider = document.getElementById('min-price');
        const maxSlider = document.getElementById('max-price');
        const priceDisplay = document.getElementById('price-display');
        const rangeFill = document.getElementById('price-range-fill');
        
        let minVal = parseInt(minSlider.value);
        let maxVal = parseInt(maxSlider.value);
        
        // Ensure min is always less than max
        if (minVal >= maxVal) {
          if (minSlider === document.activeElement) {
            maxVal = minVal + 1;
            maxSlider.value = maxVal;
          } else {
            minVal = maxVal - 1;
            minSlider.value = minVal;
          }
        }
        
        // Calculate actual price values (₱500 to ₱12,000)
        const minPrice = 500 + (minVal / 100) * (12000 - 500);
        const maxPrice = 500 + (maxVal / 100) * (12000 - 500);
        
        filterState.minPrice = Math.round(minPrice);
        filterState.maxPrice = Math.round(maxPrice);
        
        // Update display
        priceDisplay.textContent = `₱${filterState.minPrice.toLocaleString()} - ₱${filterState.maxPrice.toLocaleString()}`;
        
        // Update range fill
        const leftPercent = minVal;
        const rightPercent = 100 - maxVal;
        rangeFill.style.marginLeft = leftPercent + '%';
        rangeFill.style.width = (maxVal - minVal) + '%';
        
        updateApplyButton();
      }

      // Sort selection
      function selectSort(button, sortType) {
        // Update UI
        document.querySelectorAll('.sort-btn').forEach(btn => {
          btn.classList.remove('bg-primary', 'text-white', 'active');
          btn.classList.add('bg-gray-200', 'text-gray-700', 'dark:bg-gray-700', 'dark:text-gray-200');
        });
        
        button.classList.remove('bg-gray-200', 'text-gray-700', 'dark:bg-gray-700', 'dark:text-gray-200');
        button.classList.add('bg-primary', 'text-white', 'active');
        
        // Update state
        filterState.sortBy = sortType;
        updateApplyButton();
      }

      // Room type selection (multiple selection)
      function selectRoomType(button, roomType) {
        const isSelected = button.classList.contains('selected');
        
        if (isSelected) {
          // Deselect
          button.classList.remove('selected', 'border-primary', 'bg-primary/5', 'text-primary');
          button.classList.add('border-gray-200', 'dark:border-gray-700');
          filterState.roomTypes = filterState.roomTypes.filter(type => type !== roomType);
        } else {
          // Select
          button.classList.add('selected', 'border-primary', 'bg-primary/5', 'text-primary');
          button.classList.remove('border-gray-200', 'dark:border-gray-700');
          filterState.roomTypes.push(roomType);
        }
        
        updateApplyButton();
      }

      // Update amenities in filter state
      document.addEventListener('change', function(e) {
        if (e.target.classList.contains('amenity-checkbox')) {
          const amenity = e.target.value;
          if (e.target.checked) {
            if (!filterState.amenities.includes(amenity)) {
              filterState.amenities.push(amenity);
            }
          } else {
            filterState.amenities = filterState.amenities.filter(a => a !== amenity);
          }
          updateApplyButton();
        }
        
        if (e.target.name === 'distance') {
          filterState.distance = e.target.value;
          updateApplyButton();
        }
      });

      // Update apply button with filter count
      function updateApplyButton() {
        const applyBtn = document.getElementById('apply-btn');
        let filterCount = 0;
        
        // Count active filters
        if (filterState.minPrice > 500 || filterState.maxPrice < 12000) filterCount++;
        if (filterState.amenities.length > 0) filterCount++;
        if (filterState.roomTypes.length > 0) filterCount++;
        if (filterState.sortBy !== 'distance') filterCount++;
        if (filterState.distance !== 'bike') filterCount++;
        
        if (filterCount > 0) {
          applyBtn.textContent = `Apply Filters (${filterCount})`;
        } else {
          applyBtn.textContent = 'Apply Filters';
        }
      }

      // Reset all filters
      function resetFilters() {
        // Reset sliders
        document.getElementById('min-price').value = 0;
        document.getElementById('max-price').value = 100;
        
        // Reset checkboxes
        document.querySelectorAll('.amenity-checkbox').forEach(cb => {
          cb.checked = false;
        });
        
        // Reset sort buttons
        document.querySelectorAll('.sort-btn').forEach(btn => {
          btn.classList.remove('bg-primary', 'text-white', 'active');
          btn.classList.add('bg-gray-200', 'text-gray-700', 'dark:bg-gray-700', 'dark:text-gray-200');
        });
        
        // Select first sort option
        const firstSort = document.querySelector('.sort-btn');
        firstSort.classList.remove('bg-gray-200', 'text-gray-700', 'dark:bg-gray-700', 'dark:text-gray-200');
        firstSort.classList.add('bg-primary', 'text-white', 'active');
        
        // Reset room type buttons
        document.querySelectorAll('.room-type-btn').forEach(btn => {
          btn.classList.remove('selected', 'border-primary', 'bg-primary/5', 'text-primary');
          btn.classList.add('border-gray-200', 'dark:border-gray-700');
        });
        
        // Reset distance radio
        document.querySelector('input[name="distance"][value="bike"]').checked = true;
        
        // Reset state
        filterState = {
          minPrice: 500,
          maxPrice: 12000,
          sortBy: 'distance',
          amenities: [],
          roomTypes: [],
          distance: 'bike'
        };
        
        updatePriceRange();
        updateApplyButton();
      }

      // Clear all filters (more aggressive reset)
      function clearAllFilters() {
        resetFilters();
        
        // Visual feedback
        const clearBtn = event.target;
        const originalText = clearBtn.textContent;
        clearBtn.textContent = 'Cleared!';
        clearBtn.classList.add('bg-green-500', 'text-white');
        
        setTimeout(() => {
          clearBtn.textContent = originalText;
          clearBtn.classList.remove('bg-green-500', 'text-white');
        }, 1000);
      }

      // Apply filters
      function applyFilters() {
        // Simulate applying filters with loading state
        const applyBtn = document.getElementById('apply-btn');
        const originalText = applyBtn.textContent;
        
        applyBtn.textContent = 'Applying...';
        applyBtn.disabled = true;
        applyBtn.classList.add('opacity-70');
        
        // Log filter state for debugging
        console.log('Applied filters:', filterState);
        
        // Simulate API call delay
        setTimeout(() => {
          // In a real app, you would redirect or update the search results
          // For demo, just show success state
          applyBtn.textContent = 'Applied!';
          applyBtn.classList.remove('opacity-70');
          applyBtn.classList.add('bg-green-500');
          
          setTimeout(() => {
            // Redirect to result.html
            window.location.href = "search_results.html";
          }, 500);
        }, 1000);
    }

      // Close filters
      function closeFilters() {
        // In a real app, this would close the modal or navigate back
        // For demo, just navigate back to previous page
        history.back();
      }

      // Handle drag interaction for mobile
      let startY = 0;
      let currentY = 0;
      let isDragging = false;

      const filterModal = document.querySelector('.glassmorphism');
      const dragHandle = document.querySelector('.h-1\\.5');

      dragHandle.addEventListener('touchstart', function(e) {
        startY = e.touches[0].clientY;
        isDragging = true;
      }, { passive: true });

      document.addEventListener('touchmove', function(e) {
        if (!isDragging) return;
        
        currentY = e.touches[0].clientY;
        const deltaY = currentY - startY;
        
        if (deltaY > 0) {
          filterModal.style.transform = `translateY(${Math.min(deltaY, 300)}px)`;
        }
      }, { passive: true });

      document.addEventListener('touchend', function() {
        if (!isDragging) return;
        
        const deltaY = currentY - startY;
        
        if (deltaY > 150) {
          closeFilters();
        } else {
          filterModal.style.transform = 'translateY(0)';
        }
        
        isDragging = false;
      });
    </script>
  </body>
</html>
